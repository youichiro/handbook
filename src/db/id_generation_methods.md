# IDã®ç”Ÿæˆæ–¹æ³•
ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜ã™ã‚‹IDã®ç”Ÿæˆæ–¹æ³•ã«ã¤ã„ã¦ã¾ã¨ã‚ã¾ã™ã€‚

## AUTO_INCREMENT
DBãŒIDã‚’é€£ç•ªã§ç”Ÿæˆã™ã‚‹æ–¹å¼

- ãƒ¡ãƒªãƒƒãƒˆ
    - æ•°å€¤å‹ã§æ‰±ãˆã‚‹
        - ãƒã‚¤ãƒˆã‚µã‚¤ã‚ºãŒå°ã•ã„ã®ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ‰åˆ©
    - é€£ç•ªãªã®ã§ã‚½ãƒ¼ãƒˆå¯èƒ½
    - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç©ºé–“åŠ¹ç‡ãŒã„ã„
- ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
    - INSERTãŒå®Œäº†ã™ã‚‹ã¾ã§IDãŒã‚ã‹ã‚‰ãªã„
        - éåŒæœŸå‡¦ç†ã—ãŸã„ã¨ãã§ã‚‚å…ˆã«IDã¯è¿”ã—ãŸã„å ´åˆã€IDã‚’æ¡ç•ªã™ã‚‹ãŸã‚ã ã‘ã«å…ˆã«INSERTã—ãªã„ã¨ã„ã‘ãªã„
    - ãƒ‡ãƒ¼ã‚¿é‡ãŒå¢—ãˆã¦DBãŒè¤‡æ•°ã«ãªã£ãŸå ´åˆã€IDãŒé‡è¤‡ã™ã‚‹
## UUID
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ©ãƒ³ãƒ€ãƒ ã«IDã‚’ç”Ÿæˆã™ã‚‹æ–¹å¼

- ãƒ¡ãƒªãƒƒãƒˆ
    - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒIDã‚’ç”Ÿæˆã™ã‚‹ã®ã§ã€æ¡ç•ªã®ãŸã‚ã«DBã‚¢ã‚¯ã‚»ã‚¹ã—ãªãã¦ã„ã„
- ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
    - æ•°å€¤å‹ã§æ‰±ãˆãªã„
    - ã‚½ãƒ¼ãƒˆã§ããªã„
    - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ç©ºé–“åŠ¹ç‡ãŒæ‚ªã„
    - INSERTã«ã‹ã‹ã‚‹æ™‚é–“ãŒå¢—ãˆã¦ã„ã
        - https://kccoder.com/mysql/uuid-vs-int-insert-performance/
        - ![](images/01.png)
        - https://techblog.raccoon.ne.jp/archives/1627262796.html
        - AUTO_INCREMENTã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãªã®ã§ã€ãƒªãƒ¼ãƒ•ãƒšãƒ¼ã‚¸ã‚’é›†ä¸­ã•ã›ã‚‹ã“ã¨ãŒã§ãã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ’ãƒƒãƒˆç‡ãŒé«˜ããªã‚‹
            - => ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå¢—ãˆã¦ã‚‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯ä¸€å®šã‚’ç¶­æŒã§ãã‚‹
            - ![](images/02.png)
        - UUIDã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã§ã¯ãªã„ã®ã§ã€INSERTã™ã‚‹ãŸã³ã«ãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã®ãƒ©ãƒ³ãƒ€ãƒ ä½ç½®ã«å¯¾ã™ã‚‹ãƒªãƒ¼ãƒ•ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ãŒå¿…è¦ã«ãªã‚‹
            - => ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå¢—ãˆã‚‹ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒåŠ£åŒ–ã™ã‚‹
            - ![](images/03.png)
        - èª­ã¿è¾¼ã¿æ™‚ã¯ã€1ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹å ´åˆã¯AUTO_INCREMENTã¨UUIDã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å·®ã¯ãªã„
            - ãŒã€å®Ÿéš›ã¯æ–°ã—ã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã»ã©é »ç¹ã«èª­ã¿è¾¼ã‚€ã“ã¨ã«ãªã‚‹
            - æœ€æ–°ã®ãƒªãƒ¼ãƒ•ãƒãƒ¼ãƒ‰ã»ã©å‚ç…§é »åº¦ãŒé«˜ããªã‚Šã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒé«˜ããªã‚‹ã®ã§ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒé«˜ããªã‚‹
                - ![](images/04.png)
            - UUIDã®å ´åˆã€ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒã¯æ™‚ç³»åˆ—ã¨é–¢ä¿‚ãªã„ã®ã§ã€AUTO_INCREMENTã®ã‚ˆã†ãªæ©æµã‚’å—ã‘ã‚‹ã“ã¨ã¯ã§ããªã„
    - MySQL8 ã® [uuid_to_bin()](https://dev.mysql.com/doc/refman/8.0/ja/miscellaneous-functions.html#function_uuid-to-bin) é–¢æ•°ã‚’ä½¿ã†ã¨ã»ã¼ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãªå€¤ã«ã§ãã‚‹ã‚‰ã—ã„
        - >  UUID å€¤ãŒãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1 å½¢å¼ã«å¾“ã£ã¦ã„ãªã„å ´åˆã€æ™‚é–“éƒ¨åˆ†ã‚¹ãƒ¯ãƒƒãƒ”ãƒ³ã‚°ã«ã¯åˆ©ç‚¹ãŒã‚ã‚Šã¾ã›ã‚“

## ULID
UUIDã¨åŒã˜ããƒ©ãƒ³ãƒ€ãƒ ã«å€¤ã‚’ç”Ÿæˆã™ã‚‹ãŒã€å…ˆé ­ãŒã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—æˆåˆ†ã«ãªã£ã¦ã„ã‚‹æ–¹å¼

- ãƒ¡ãƒªãƒƒãƒˆ
    - æ™‚ç³»åˆ—ã®ä¸¦ã³ã«ãªã‚‹ãŸã‚ã€UUIDã®æ¬ ç‚¹ã‚’å…‹æœã§ãã‚‹
    - ã‚½ãƒ¼ãƒˆã§ãã‚‹
    - åŒä¸€ãƒŸãƒªç§’å†…ã§ã®ç”Ÿæˆã§ã‚‚ã€åŒã˜ãƒŸãƒªç§’å†…ã«2^80 ã‚’è¶…ãˆãªã„é™ã‚Šã€ã‚½ãƒ¼ãƒˆé †ãŒä¿è¨¼ã•ã‚Œã‚‹
- ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
    - æ•°å€¤å‹ã§æ‰±ãˆãªã„


## ç”Ÿæˆæ‰‹é †
### pythonã®ULIDãƒ©ã‚¤ãƒ–ãƒ©ãƒª
https://github.com/ahawker/ulid
```sh
pip install ulid-py
```
```python
>>> import ulid
>>> ulid.new()
<ULID('01GPN7CM2HS8A552Q7DX9D24R7')>
>>> id = ulid.new()
>>> id.str
'01GPN7FK0E0WY9QF46MPK0SRVK' # 26æ–‡å­—
>>> id.int
2023260978905909068547623492420166515 # æ•°å€¤å‹ã§ã‚‚ã‚ˆã‹ã£ãŸã‚Šã™ã‚‹ã®ã‹ãªğŸ¤”
```

## å‚è€ƒ
- https://zenn.dev/j5ik2o/articles/a085ab3e3d0f197f6559
- https://zenn.dev/praha/articles/3c84e3818891c3
- https://techblog.raccoon.ne.jp/archives/1627262796.html
